
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Transformations &#8212; Linear Models III: Assumptions, Diagnostics and Transformations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5.transformations';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary" href="summary.html" />
    <link rel="prev" title="Diagnostic Plots" href="4.diagnostic-plots.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models III: Assumptions, Diagnostics and Transformations - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models III: Assumptions, Diagnostics and Transformations - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.assumptions.html">The Linear Model Assumptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.data-features.html">Data Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.diagnostic-measures.html">Diagnostic Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.diagnostic-plots.html">Diagnostic Plots</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Assumptions-Diagnostics-Transforms" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Assumptions-Diagnostics-Transforms/issues/new?title=Issue%20on%20page%20%2F5.transformations.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5.transformations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Transformations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-outcome">Transforming the Outcome</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#box-cox-transformations">Box-Cox Transformations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-predictors">Transforming the Predictors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearising-relationships">Linearising Relationships</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#box-tidwell">Box-Tidwell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-transforms-further">Visualising Transforms Further</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomial-regression">Polynomial Regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardised-regression">Standardised Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-if-nothing-works">What if Nothing Works?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="transformations">
<h1>Transformations<a class="headerlink" href="#transformations" title="Link to this heading">#</a></h1>
<p>In the final part of this lesson, we will discuss variable transformations. These can be applied either to the <em>outcome</em> variable or to the <em>predictor</em> variables and can be used for a variety of reasons. Often, transformations are employed so that the model fits better or to correct for violations of certain assumptions. Other times, transformations can be used to help the interpretation of the model. In this part of the lesson, we will discuss methods of transformation for all these purposes as well as providing advice for choosing suitable transformations.</p>
<section id="transforming-the-outcome">
<h2>Transforming the Outcome<a class="headerlink" href="#transforming-the-outcome" title="Link to this heading">#</a></h2>
<p>We will start by looking at transforming the outcome variable. Typically, these transformations concern improving the model fit, but can also be used to improve the model assumptions, given that any transformation applied to the outcome will be carried into a transformation of the residuals. However, we need to be clear about the types of transformations we apply to the data. Typically, we only want to consider transformations that are <em>monotonic</em>. This means that the order of the data is preserved. One example would be taking <span class="math notranslate nohighlight">\(\log y_{i}\)</span>, as the data will remain in the same order. However, an example of a <em>non-monotonic</em> transformation would be the absolute value <span class="math notranslate nohighlight">\(|y_{i}|\)</span> because if there are <em>negative</em> measures of <span class="math notranslate nohighlight">\(y\)</span> they will be made <em>positive</em> and the data order will change. A similar situation happens with negative values and <span class="math notranslate nohighlight">\(y^{2}\)</span>. In general, we need to only consider those transformations that are <em>scaling</em> our data, nothing more.</p>
<section id="box-cox-transformations">
<h3>Box-Cox Transformations<a class="headerlink" href="#box-cox-transformations" title="Link to this heading">#</a></h3>
<p>Although we are restricting ourselves to monotonic transformations, that still leaves a wide array of possible approaches. For instance, all the following are potential monotonic transformations:</p>
<ul class="simple">
<li><p>Addition/Subtraction of a constant</p></li>
<li><p>Multiplication/Division by a positive constant</p></li>
<li><p>Exponents with a positive base</p></li>
<li><p>Logarithmic transformations</p></li>
<li><p>Square-Root transformation</p></li>
<li><p>Arcsine transformation</p></li>
</ul>
<p>Given that there are a wide variety of possible transformations, we could simply guess and try lots of different transformations to see what happens. This is a perfectly acceptable approach, though it is neither very principled nor efficient. We could also look for guidelines on what transformations are best for reducing properties such as skew or extreme values. This is a bit more principled, but is still not particularly efficient.</p>
<p>A much better method was given by <a class="reference external" href="http://www.econ.illinois.edu/~econ508/Papers/boxcox64.pdf">Box &amp; Cox (1964)</a>. Here, transformations of the form <span class="math notranslate nohighlight">\(y^{\lambda}\)</span> are considered. When <span class="math notranslate nohighlight">\(\lambda \neq 0\)</span> this is a simple power transformation and when <span class="math notranslate nohighlight">\(\lambda = 0\)</span> this is defined as <span class="math notranslate nohighlight">\(\log y\)</span>. This format then encompasses a wide-range of possible transformations. For instance</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\lambda\)</span> value</p></th>
<th class="head"><p>Transformation</p></th>
<th class="head"><p>Equivalent Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y^{2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(y\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0.5</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{1/2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{y}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.33</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{1/3}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt[3]{y}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\log(y)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\log_{e}(y)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>-0.5</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{-1/2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{\sqrt{y}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p><span class="math notranslate nohighlight">\(y^{-1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{y}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>The utility of this method is that the value of <span class="math notranslate nohighlight">\(\lambda\)</span> that makes the data most probable can be found using maximum likelihood. This means that rather than searching through lots of possible transformations, we can just run the Box-Cox method and then evaluate whether a transform seems necessary. Of note, however, is that</p>
<ul class="simple">
<li><p>Box-Cox is only defined for <span class="math notranslate nohighlight">\(y &gt; 0\)</span>. If the data has negative or 0 values, it will need to first be offset by adding a constant to make all values greater than 0.</p></li>
<li><p>The value of <span class="math notranslate nohighlight">\(\lambda\)</span> returned can be anything, which can make the transformed data hard to interpret. If the returned value is close to a more intepretable transformation, you may wish to choose that instead.</p></li>
<li><p>Box-Cox is sensitive to outliers, so if you get very large estimated values of <span class="math notranslate nohighlight">\(\lambda\)</span> (such as <span class="math notranslate nohighlight">\(\hat{\lambda} = 5\)</span>), then this is likely the reason. Extreme transformations are almost never warranted.</p></li>
</ul>
<p>As an example, we can use the <code class="docutils literal notranslate"><span class="pre">boxcox()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">MASS</span></code> package on our model of <code class="docutils literal notranslate"><span class="pre">mpg</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">box</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">boxcox</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/4b64a993044cf1d485282ce521b76bb0f2bda16acc456e1d264649a63fa0c57d.png"><img alt="_images/4b64a993044cf1d485282ce521b76bb0f2bda16acc456e1d264649a63fa0c57d.png" src="_images/4b64a993044cf1d485282ce521b76bb0f2bda16acc456e1d264649a63fa0c57d.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>The plot shows all the values of <span class="math notranslate nohighlight">\(\lambda\)</span> that were considered along the <span class="math notranslate nohighlight">\(x\)</span>-axis and a plot of the log-likelihood along the <span class="math notranslate nohighlight">\(y\)</span>-axis. We can see that the value that maximises the likelihood is very close to 0, and so we may want to consider a simple log-transformation. If we want to know the precise value of <span class="math notranslate nohighlight">\(\hat{\lambda}\)</span> here, we can use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lik</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">box</span><span class="o">$</span><span class="n">y</span>
<span class="n">lam</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">box</span><span class="o">$</span><span class="n">x</span><span class="w"> </span>
<span class="n">best.lam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lam</span><span class="p">[</span><span class="n">lik</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">lik</span><span class="p">)]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">best.lam</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] -0.02020202
</pre></div>
</div>
</div>
</div>
<p>We could include this in the regression model by using the formula <code class="docutils literal notranslate"><span class="pre">I(mpg^best.lam)</span> <span class="pre">~</span> <span class="pre">wt</span> <span class="pre">+</span> <span class="pre">hp</span> <span class="pre">+</span> <span class="pre">cy</span></code>, however, this is equivalent to the transformation <span class="math notranslate nohighlight">\(\frac{1}{\text{MPG}^{0.02}}\)</span>, which is not very interpretable. Given that this is very close to <span class="math notranslate nohighlight">\(\hat{\lambda} = 0\)</span>, we would choose the log-transformation instead. We try this below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">log.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">log.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(mpg) ~ wt + hp + cyl, data = mtcars)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.14769 -0.07440 -0.02094  0.06940  0.25102 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.8846131  0.0778794  49.880  &lt; 2e-16 ***
wt          -0.1746533  0.0322776  -5.411 9.03e-06 ***
hp          -0.0010434  0.0005176  -2.016   0.0535 .  
cyl         -0.0342858  0.0240114  -1.428   0.1644    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.1095 on 28 degrees of freedom
Multiple R-squared:  0.8779,	Adjusted R-squared:  0.8649 
F-statistic: 67.13 on 3 and 28 DF,  p-value: 6.647e-13
</pre></div>
</div>
</div>
</div>
<p>We can then create the assumptions plots from the <em>untransformed</em> model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/96ff29ddb426e349a83cf67bfcda3fbdcb11598244d60e091a290652892c84e3.png"><img alt="_images/96ff29ddb426e349a83cf67bfcda3fbdcb11598244d60e091a290652892c84e3.png" src="_images/96ff29ddb426e349a83cf67bfcda3fbdcb11598244d60e091a290652892c84e3.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>And compared them to the log-transformed model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">log.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1d9c8707f644523c9d0e8def427d489c208b1c7fcd09b20d9ecf8803a2c5ffa4.png"><img alt="_images/1d9c8707f644523c9d0e8def427d489c208b1c7fcd09b20d9ecf8803a2c5ffa4.png" src="_images/1d9c8707f644523c9d0e8def427d489c208b1c7fcd09b20d9ecf8803a2c5ffa4.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>This does seem to have helped, particularly in terms of linearising the relationships in the data and bringing in some of the heavier tails of the residual distribution. We can see this improvement in fit by examining the effects plot for the transformed model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">log.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/e341c2c5f9030270d5f3c6d3737d2b03534a2e5300284499563c366f4007517a.png"><img alt="_images/e341c2c5f9030270d5f3c6d3737d2b03534a2e5300284499563c366f4007517a.png" src="_images/e341c2c5f9030270d5f3c6d3737d2b03534a2e5300284499563c366f4007517a.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Although this seems like a successful application of the Box-Cox method, we always need to take interpretation into account when dealing with transformations. The meaning of the regression coefficients has now changed as they correspond to how much the <em>log</em> of the outcome changes for a unit increase in each predictor. This might be harder to understand and could be enough to dissuade you from considering a transformations of the outcome, even if the model fit can be improved. As always, a decision must be made about whether to prioritise the model fit or interpretation.</p>
</section>
</section>
<section id="transforming-the-predictors">
<h2>Transforming the Predictors<a class="headerlink" href="#transforming-the-predictors" title="Link to this heading">#</a></h2>
<p>As well as the outcome, we can also consider transformations applied to the predictors. Typically, these would be used to improve the model fit by either linearising certain relationships in the data, or to model those non-linearities directly. In other words, we can either try and <em>remove</em> any curved relationships so that a straight-line will work, or we can alter the regression model so that it <em>includes</em> curved relationships as part of its predictions. We will see examples of both below.</p>
<section id="linearising-relationships">
<h3>Linearising Relationships<a class="headerlink" href="#linearising-relationships" title="Link to this heading">#</a></h3>
<p>We start by examining methods that aim to <em>remove</em> any non-linearities in the relationship between the outcome and the predictor. We saw earlier how this can be achieved in part by transforming the outcome variable, though there were some issues with doing so, particularly around intepretation. As such, we may choose to instead transform the associated predictor variables. This can be more effective, particularly in the context of multiple regression, as different predictors may require different transformations depending upon the form of each relationship. Rather than transform the whole outcome, we can instead taylor the transformation to each predictor separately in a bid to remove any non-linearities from the data.</p>
<section id="box-tidwell">
<h4>Box-Tidwell<a class="headerlink" href="#box-tidwell" title="Link to this heading">#</a></h4>
<p>As we saw earlier, we could spend some time guessing the appropriate transformations. However, this is not the most efficient approach. Instead, we can use a variant of the Box-Cox method designed for the <em>predictor</em> variables, known as the Box-Tidwell approach. Like Box-Cox, the transformations are defined in terms of raising predictor <span class="math notranslate nohighlight">\(j\)</span> to the power of <span class="math notranslate nohighlight">\(\lambda_{j}\)</span>, where the values of <span class="math notranslate nohighlight">\(\lambda\)</span> that best linearises the relationship can be found be MLE.</p>
<p>As an example, the <code class="docutils literal notranslate"><span class="pre">boxTidwell()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">car</span></code> package takes 3 inputs. The model formula, including those predictors that are candidates for transformation (i.e. <code class="docutils literal notranslate"><span class="pre">wt</span></code> and <code class="docutils literal notranslate"><span class="pre">hp</span></code>), a one-sided formula including those predictors that are <em>not</em> candidates for transformation but remain in the model (i.e. <code class="docutils literal notranslate"><span class="pre">cyl</span></code>), and the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="n">box.t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">boxTidwell</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">box.t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   MLE of lambda Score Statistic (z) Pr(&gt;|z|)   
wt      -0.52177              2.6058 0.009165 **
hp      61.47640              2.1040 0.035382 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

iterations =  26 
</pre></div>
</div>
</div>
</div>
<p>Here we can see that the value of each <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> that best linearises the relationships between each predictor and the outcome are found by MLE. The estimate of <span class="math notranslate nohighlight">\(\hat{\lambda}_{1} = -0.52\)</span> seems reasonable. However, <span class="math notranslate nohighlight">\(\hat{\lambda}_{2} = 61.48\)</span> is entirely implausible. As mentioned earlier, these methods are highly sensitive to outliers. As such, we can try running this function again using the <code class="docutils literal notranslate"><span class="pre">subset</span></code> argument to remove observations with studentised residuals greater than 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">resid.t</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rstudent</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">))</span>
<span class="n">not.outliers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">resid.t</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2</span>
<span class="n">box.t</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">boxTidwell</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="n">subset</span><span class="o">=</span><span class="n">not.outliers</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">box.t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   MLE of lambda Score Statistic (z) Pr(&gt;|z|)  
wt     -0.058479              1.9374  0.05269 .
hp     -0.124602              1.3069  0.19124  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

iterations =  6 
</pre></div>
</div>
</div>
</div>
<p>This seems much more reasonable. We can plug these results into the model as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lambda</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">box.t</span><span class="o">$</span><span class="n">result</span>
<span class="n">wt.transf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="o">^</span><span class="n">lambda</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="n">hp.transf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span><span class="o">^</span><span class="n">lambda</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="n">box.t.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt.transf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp.transf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">box.t.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/be60afabc7170c05ead043ee62e0a45e9629e250e5575714210189ecafc84bec.png"><img alt="_images/be60afabc7170c05ead043ee62e0a45e9629e250e5575714210189ecafc84bec.png" src="_images/be60afabc7170c05ead043ee62e0a45e9629e250e5575714210189ecafc84bec.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>So this had done the job. However, we hit an interpretational issues becuase what exactly does <span class="math notranslate nohighlight">\(\frac{1}{\text{weight}^{0.06}}\)</span> or <span class="math notranslate nohighlight">\(\frac{1}{\text{horsepower}^{0.12}}\)</span> mean? Instead, we can see that both results from the Box-Tidwell method are quite close to 0, which would give us <span class="math notranslate nohighlight">\(\log{\text{weight}}\)</span> and <span class="math notranslate nohighlight">\(\log{\text{horsepower}}\)</span>. We can try these instead and see what happens</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wt.transf</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
<span class="n">hp.transf</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span><span class="p">)</span>
<span class="n">transf.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt.transf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp.transf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">transf.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7f72c722781abb22413256bb912a955b5e5c0d3de802f33073666659a8e5551c.png"><img alt="_images/7f72c722781abb22413256bb912a955b5e5c0d3de802f33073666659a8e5551c.png" src="_images/7f72c722781abb22413256bb912a955b5e5c0d3de802f33073666659a8e5551c.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>So the fit is very similar, but we have used transformations that are easier to interpret, particularly as we are not using the reciprocal of the variables and thus reversing the direction of the effects. Even if the exact Box-Tidwell results give us a better model fit, we may wish to compromise this for ease of interpretation. Again, this is a call that must be made by <em>you</em> as the data analyst.</p>
</section>
<section id="visualising-transforms-further">
<h4>Visualising Transforms Further<a class="headerlink" href="#visualising-transforms-further" title="Link to this heading">#</a></h4>
<p>One of the more useful aspects of the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package is that if the transformation is embedded in the model equation, it will be reverse when the effect is plotted and you can see the shape that is being <em>removed</em> from the data, on the original scale.  So, in these examples, think of the plot as showing the curve that is being <em>removed</em> in order to linearise the relationship and make a straight-line suitable. In the example below, we stick to the transforms derived from the Box-Tidwell method, but implement them within the model equation so that the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package is aware of them. When we do this and plot the data, we can effectively see the shape of the relationship implied by the transformation. So these relationships are <em>linear</em> on the transformed scale and <em>non-linear</em> on their original scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">transf.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wt</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">hp</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">transf.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/47245879cc86267a9278cc6cf3a4b824d2f627defe2bebe5747b71758611e211.png"><img alt="_images/47245879cc86267a9278cc6cf3a4b824d2f627defe2bebe5747b71758611e211.png" src="_images/47245879cc86267a9278cc6cf3a4b824d2f627defe2bebe5747b71758611e211.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
</section>
</section>
<section id="polynomial-regression">
<h3>Polynomial Regression<a class="headerlink" href="#polynomial-regression" title="Link to this heading">#</a></h3>
<p>Although we can see how predictor transforms are able to help meet the assumptions of the regression model, doing so comes with a cost in terms of interpretation. Although we can make a straight-line work by turning <span class="math notranslate nohighlight">\(\text{weight} \rightarrow \frac{1}{\text{weight}^{0.06}}\)</span>, it might not be very clear what this <em>means</em>. Even a more standard transformation such as <span class="math notranslate nohighlight">\(\log\text{weight}\)</span> comes with some conceptual burden in terms of trying to understand our model estimates on the log-scale. Thus, we can end up in a situation where the model fits very well, but we cannot explain any of the results.</p>
<p>An alternative, and often preferable approach, is not to change the predictors to suit the model. Instead, we change the model to suit the predictors. So, rather than trying to <em>remove</em> curvature from the data, we could instead <em>include</em> curvature in the model. This means that we do not change the predictors, instead we change the model by introducting a <em>function</em> of the predictors. The simplest way of doing this is to use a <em>polynomial</em> function of each predictor we want to model as a curved relationship.</p>
<p>A polynomial of degree <span class="math notranslate nohighlight">\(d\)</span> is a function of a single predictor of the following form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    \text{poly}_{d}\left(x_{i}\right)   &amp;= \beta_{0}x_{i}^{0} + \beta_{1}x_{i}^{1} + \beta_{2}x_{i}^{2} + \cdots + \beta_{d}x_{i}^{d} \\
                                        &amp;= \beta_{0} + \beta_{1}x_{i} + \sum_{p=2}^{d} \beta_{p}x_{i}^{p}.
\end{align*}
\end{split}\]</div>
<p>Effectively, we just raise <span class="math notranslate nohighlight">\(x_{i}\)</span> to as many powers as we like and then plug them into the regression equation. This fits a <em>curve</em> to the data, where the number of <em>bends</em> in the curve is controlled by the degree <span class="math notranslate nohighlight">\(d\)</span>. For <span class="math notranslate nohighlight">\(d &gt; 0\)</span>, the curve of the line will have <span class="math notranslate nohighlight">\(d-1\)</span> bends. For instance, a polynomial of <span class="math notranslate nohighlight">\(d=1\)</span> is linear and fits a straight-line with <span class="math notranslate nohighlight">\(d-1 = 0\)</span> bends. A polynomial of <span class="math notranslate nohighlight">\(d=2\)</span> (known as a <em>quadratic</em> polynomial) fits a curved line with <span class="math notranslate nohighlight">\(d-1 = 1\)</span> bend. A polynomial of <span class="math notranslate nohighlight">\(d=3\)</span> (known as a <em>cubic</em> polynomial) fits a curved line with <span class="math notranslate nohighlight">\(d-1=2\)</span> bends, and so on. The regression coefficients will then control the <em>direction</em> of the curve, as well as the <em>location</em> of the bends, allowing the prediction to flexibly bend upwards or downwards, depending upon the best fit to the data.</p>
<p>We can include polynomials in <code class="docutils literal notranslate"><span class="pre">R</span></code> using the <code class="docutils literal notranslate"><span class="pre">poly()</span></code> function. Looking at the plots of both <code class="docutils literal notranslate"><span class="pre">wt</span></code> and <code class="docutils literal notranslate"><span class="pre">hp</span></code>, they both look like there is a single bend in the relationship, which would imply a <em>quadratic</em> realationship using <span class="math notranslate nohighlight">\(d=2\)</span>. We can try this in <code class="docutils literal notranslate"><span class="pre">R</span></code> using.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">poly.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="nf">poly</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">poly</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">poly.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ poly(wt, degree = 2) + poly(hp, degree = 2) + 
    cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7956 -1.8425 -0.3851  1.4348  4.5607 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            19.51609    3.61441   5.400 1.17e-05 ***
poly(wt, degree = 2)1 -18.70421    3.75554  -4.980 3.54e-05 ***
poly(wt, degree = 2)2   6.37935    2.36169   2.701  0.01200 *  
poly(hp, degree = 2)1 -13.63792    4.87670  -2.797  0.00959 ** 
poly(hp, degree = 2)2   5.67410    2.93010   1.936  0.06375 .  
cyl                     0.09285    0.58083   0.160  0.87422    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.174 on 26 degrees of freedom
Multiple R-squared:  0.8908,	Adjusted R-squared:  0.8698 
F-statistic: 42.43 on 5 and 26 DF,  p-value: 1.077e-11
</pre></div>
</div>
</div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">poly()</span></code> function adds extra terms to the regression model in order to capture the assumed shape of the curve. Here, we can think of these as the linear and qudratic <em>components</em> of the curve<a class="footnote-reference brackets" href="#poly-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Note that this is one <em>disadvantage</em> of a polynomial model over a transformed model, as the polynomial adds extra terms meaning we lose error degrees of freedom.</p>
<p>Like the transformed model, we can use the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package to see the shape that has, this time, actually been fit to the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">poly.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0f582522a6408de775a86c4887e670ab8fa08a3543c2b332c62812a45bbe0a9a.png"><img alt="_images/0f582522a6408de775a86c4887e670ab8fa08a3543c2b332c62812a45bbe0a9a.png" src="_images/0f582522a6408de775a86c4887e670ab8fa08a3543c2b332c62812a45bbe0a9a.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>As in the case of transformations, the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package is smart enough to combine the coefficients for the polynomial terms to show the fit for each variable. We could also try a higher-degree for <code class="docutils literal notranslate"><span class="pre">wt</span></code>, if we believed that 3 bends would best capture this relationship.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">poly.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="nf">poly</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">poly</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">poly.mod</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">allEffects</span><span class="p">(</span><span class="n">poly.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ poly(wt, degree = 3) + poly(hp, degree = 2) + 
    cyl, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-2.624 -1.450 -0.274  1.062  5.042 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            21.7394     3.9911   5.447 1.18e-05 ***
poly(wt, degree = 3)1 -16.6136     4.0721  -4.080 0.000403 ***
poly(wt, degree = 3)2   5.6993     2.3983   2.376 0.025458 *  
poly(wt, degree = 3)3  -3.1619     2.5224  -1.254 0.221617    
poly(hp, degree = 2)1 -12.7539     4.8753  -2.616 0.014870 *  
poly(hp, degree = 2)2   5.3497     2.9100   1.838 0.077913 .  
cyl                    -0.2665     0.6421  -0.415 0.681683    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.151 on 25 degrees of freedom
Multiple R-squared:  0.8973,	Adjusted R-squared:  0.8726 
F-statistic:  36.4 on 6 and 25 DF,  p-value: 3.54e-11
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/83fbe063598663b27e7a3869c7c98dc49910a8c1ce19be40210abfa3b4cc0e76.png"><img alt="_images/83fbe063598663b27e7a3869c7c98dc49910a8c1ce19be40210abfa3b4cc0e76.png" src="_images/83fbe063598663b27e7a3869c7c98dc49910a8c1ce19be40210abfa3b4cc0e76.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>There is now an extra wiggle in the fitted relationship between <code class="docutils literal notranslate"><span class="pre">wt</span></code> and <code class="docutils literal notranslate"><span class="pre">mpg</span></code>, governed by the additional model term. However, we can see that this component is not significant and thus may not be adding anything useful to the model. This would appear to be supported by the visualisation. In general, we would not recommend fitting shapes with <span class="math notranslate nohighlight">\(d &gt; 4\)</span> to keep the models simpler, keep interpretation easier and to reduce the risk of the shape being governed more by the noise in the data (an issue known as <em>overfitting</em>).</p>
</section>
</section>
<section id="standardised-regression">
<h2>Standardised Regression<a class="headerlink" href="#standardised-regression" title="Link to this heading">#</a></h2>
<p>A final use for transformation in a regression model is less about improving the model fit and more about aiding <em>interpretation</em> of the regression model. One particular issue with the regression models we have seen so far is that their interpretation depends entirely upon the scale of both the outcome variable and each individual predictor variable. Remember that a regression coefficient can be interpreted as the change in the outcome for a unit change in the predictor. This has several consequences for interpretation:</p>
<ul class="simple">
<li><p>Interpreting the magnitude of change in the outcome requires understanding the scale upon which the outcome is measured</p></li>
<li><p>Interpreting a unit change in a predictor requires understanding the scale upon which the predictor is measured</p></li>
<li><p>Because the coefficient is tied to the scale of the predictor, we cannot compare the magnitude of the coefficients across different predictors in any meaningful way</p></li>
</ul>
<p>For variables that are well characterised on a scale that is well-understood, perhaps with some known normative data, these values can be meaningfully interpreted. However, as is often the case in Experimental Psychology, if the variables in question are not well-characterised and do not have easily interpretable units, then we face a problem in interpreting the regression coefficients. Furthermore, if we want some sense of where the <em>biggest</em> relationships lie, we have no means of comparing the coefficients to each other.</p>
<p>The solution in these situations is to use <em>standardised regression</em>. This is a form of transformation where both the outcome and the predictors are re-scaled into units of standard deviations (sometimes known as <span class="math notranslate nohighlight">\(z\)</span>-scores). This is achieved by subtracting the mean from each datapoint and then dividing by the standard deviation</p>
<div class="math notranslate nohighlight">
\[
x^{(z)}_{i} = \frac{x_{i} - \bar{x}}{\text{SD}\left\{x\right\}}.
\]</div>
<p>This can be computer either manually in <code class="docutils literal notranslate"><span class="pre">R</span></code>, or by using the built-in <code class="docutils literal notranslate"><span class="pre">scale()</span></code> function. Using the re-scaled variables then leads to a regression model that can be interpreted in terms of the change in the outcome on the standard deviation scale after 1 standard deviation change in each predictor. Furthermore, because all the predictors are now on the same scale, we can compared their magnitudes in a meaningful way.</p>
<p>As an example, we can fit a standardised version of our <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> model. Notice that standardisation will always render the intercept 0, so it can be removed from the model by adding <code class="docutils literal notranslate"><span class="pre">-1</span></code> to the model formula.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mpg.z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
<span class="n">wt.z</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
<span class="n">hp.z</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">hp</span><span class="p">)</span>
<span class="n">cyl.z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">)</span>
<span class="n">mod.z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg.z</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt.z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hp.z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cyl.z</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">mod.z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg.z ~ wt.z + hp.z + cyl.z - 1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65191 -0.25880 -0.08813  0.19662  0.97870 

Coefficients:
      Estimate Std. Error t value Pr(&gt;|t|)    
wt.z   -0.5141     0.1181  -4.352 0.000153 ***
hp.z   -0.2052     0.1328  -1.546 0.133016    
cyl.z  -0.2790     0.1604  -1.739 0.092564 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.4095 on 29 degrees of freedom
Multiple R-squared:  0.8431,	Adjusted R-squared:  0.8269 
F-statistic: 51.96 on 3 and 29 DF,  p-value: 8.794e-12
</pre></div>
</div>
</div>
</div>
<p>We can now interpet the standardised model. To begin with, we can rank the effects in terms of the magnitude of their coefficients. <code class="docutils literal notranslate"><span class="pre">wt</span></code> has the largest effect, followed by <code class="docutils literal notranslate"><span class="pre">cyl</span></code> and then <code class="docutils literal notranslate"><span class="pre">hp</span></code>. In this way, standardisation gives a useful form of <em>effect size</em> that can be used to intepret the model more clearly. In terms of the individual coefficients, we can now interpret each on the scale of standard deviation. For instance, the <code class="docutils literal notranslate"><span class="pre">wt</span></code> effect of <span class="math notranslate nohighlight">\(\hat{\beta}_{1} = -0.51\)</span> indicates that an increase of 1 standard deviation of <code class="docutils literal notranslate"><span class="pre">wt</span></code> results in a reduction in <code class="docutils literal notranslate"><span class="pre">mpg</span></code> of <span class="math notranslate nohighlight">\(0.51\)</span> standard deviations. If we want to, we can then classify the magnitude of this effect using Cohen’s guidelines of 0.10-0.29 being <em>small</em>, 0.30-0.49 are <em>medium</em>, and 0.50 or greater are <em>large</em>. So, in the model above, we have one <em>large</em> effect and two <em>small</em> effects. Though note that such <em>trichotomisation</em> of evidence is not much better than binarising results into <em>significant</em> and <em>non-significant</em>.</p>
</section>
<section id="what-if-nothing-works">
<h2>What if Nothing Works?<a class="headerlink" href="#what-if-nothing-works" title="Link to this heading">#</a></h2>
<p>These include models for outliers (<em>robust regression</em>), heteroscedasticity (<em>generalised least squares</em>), multicollinearity (<em>ridge regression</em>) and non-normality (<em>non-parametric resampling</em>).</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="poly-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>This is only because the <code class="docutils literal notranslate"><span class="pre">poly()</span></code> function constructs what are known as <em>orthogonal</em> polynomials. This will not be the same as fitting a model using <code class="docutils literal notranslate"><span class="pre">mpg</span> <span class="pre">~</span> <span class="pre">wt</span> <span class="pre">+</span> <span class="pre">I(wt^2)</span> <span class="pre">+</span> <span class="pre">hp</span> <span class="pre">+</span> <span class="pre">I(hp^2)</span> <span class="pre">+</span> <span class="pre">cyl</span></code>.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4.diagnostic-plots.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diagnostic Plots</p>
      </div>
    </a>
    <a class="right-next"
       href="summary.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Summary</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-outcome">Transforming the Outcome</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#box-cox-transformations">Box-Cox Transformations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-predictors">Transforming the Predictors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearising-relationships">Linearising Relationships</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#box-tidwell">Box-Tidwell</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-transforms-further">Visualising Transforms Further</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomial-regression">Polynomial Regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardised-regression">Standardised Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-if-nothing-works">What if Nothing Works?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr George Farmer & Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>